---
title: 리액트 - state 업데이트, state 입력에 반응하기, state 구조 선택
date: 2024-03-05 00:00:00 +09:00
categories: [프론트엔드, 리액트]
tags: [프론트엔드, 리액트]
---

## state 업데이트

React state 객체는 기술적으로 변이할 수 있지만, 숫자, 불리언, 문자열과 같이 불변인 것처럼 취급해야 합니다. 객체를 직접 변이하는 대신, 항상 교체해야 합니다.

### state를 읽기 전용으로 취급하세요

다시 말해 **state에 넣는 모든 JavaScript 객체를 읽기 전용으로 취급해야** 합니다.

state 설정자 함수를 사용하지 않으면 React는 객체가 변이되었다는 사실을 알지 못합니다. 그래서 React는 아무 반응도 하지 않습니다. 이미 음식을 다 먹은 후에 주문을 바꾸려고 하는 것과 같다. state 변이는 경우에 따라 작동할 수 있지만 권장하지 않는다. 렌더링에서 접근할 수 있는 state 값은 읽기 전용으로 취급해야 합니다.

이 경우 리렌더링을 트리거하려면 **새 객체를 생성하고 state 설정자 함수에 전달**하세요.

setState는 React에 다음을 지시합니다:

- state를 이 새 객체로 바꿔라.
- 이 컴포넌트를 다시 렌더링하라.

### 지역 변이는 괜찮습니다.

이와 같은 코드는 기존 객체의 state를 수정하기 때문에 문제가 됩니다.

```
position.x = e.clientX;
position.y = e.clientY;
```

그러나 이와 같은 코드는 방금 생성한 객체를 변이하는 것이기 때문에 **완전히 괜찮습니다:**

```
const nextPosition = {};
nextPosition.x = e.clientX;
nextPosition.y = e.clientY;
setPosition(nextPosition);
```

### 리액트에서 state 변이를 권장하지 않는 이유

- 최적화: React 최적화 전략은 state가 다음 프로퍼티나 state가 동일한 경우 작업을 건너뛰는 것에 의존한다. state가 불변하다면 변경이 있었는지 확인하는 것이 매우 빠릅니다. 만약 prevObj === obj라면, 내부에 변경된 것이 없다는 것을 확신할 수 있습니다.
- 새로운 기능: 새 React기능은 state가 스냅샷처럼 취급되는 것에 의존합니다. state를 변이하는 경우 새로운 기능을 사용하지 못할 수 있다.

## state로 입력에 반응하기

React에서는 직접 UI를 조작하지 않습니다. 대신 **표시할 내용을 선언하면** React가 UI를 업데이트할 방법을 알아냅니다.

### UI를 선언적인 방식으로 생각하기

React로 사고하는 방법을 더 잘 이해하기 위해 UI를 React로 구현하는 과정을 살펴봅시다:

1. 컴포넌트의 다양한 시각적 상태를 **표현**합니다.
2. 상태 변화를 촉발하는 요소를 **파악**합니다.
3. `useState`를 사용하여 메모리의 상태를 **표현**합니다.
4. 비필수적인 state 변수를 **제거**합니다.
5. 이벤트 핸들러를 **연결**하여 state를 설정합니다.

## state 구조 선택

### state 구조화 원칙

1. **관련 state를 그룹화합니다.** 항상 두 개 이상의 state를 동시에 업데이트하는 경우 단일 state 변수로 병합하는 것이 좋습니다.
2. **state 모순을 피하세요.** 여러 state 조각이 서로 모순되거나 '불일치'할 수 있는 방식으로 state를 구성하면 실수가 발생할 여지가 생깁니다. 이를 피하세요.
3. **불필요한 state를 피하세요.** 렌더링 중에 컴포넌트의 props나 기존 state 변수에서 일부 정보를 계산할 수 있다면 해당 정보를 해당 컴포넌트의 state에 넣지 않아야 합니다.
4. **state 중복을 피하세요.** 동일한 데이터가 여러 state 변수 간에 또는 중첩된 객체 내에 중복되면 동기화 state를 유지하기가 어렵습니다. 가능하면 중복을 줄이세요.
5. **깊게 중첩된 state는 피하세요.** 깊게 계층화된 state는 업데이트하기 쉽지 않습니다. 가능하면 state를 평평한 방식으로 구성하는 것이 좋습니다.
